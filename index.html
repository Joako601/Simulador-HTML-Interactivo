<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simulador de Algoritmos de Asignación de Memoria</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #0f172a;
            padding: 20px;
            min-height: 100vh;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: #1e293b;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
        }

        h1 {
            text-align: center;
            color: #38bdf8;
            margin-bottom: 10px;
            font-size: 2.5em;
        }

        .subtitle {
            text-align: center;
            color: #94a3b8;
            margin-bottom: 30px;
            font-size: 1.1em;
        }

        .controls {
            background: #334155;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 30px;
            border: 1px solid #475569;
        }

        .control-group {
            margin-bottom: 20px;
        }

        .control-group label {
            display: block;
            font-weight: bold;
            margin-bottom: 8px;
            color: #e2e8f0;
        }

        .control-group input {
            width: 100%;
            padding: 10px;
            border: 2px solid #475569;
            border-radius: 5px;
            font-size: 14px;
            background: #1e293b;
            color: #e2e8f0;
        }

        .control-group input:focus {
            outline: none;
            border-color: #38bdf8;
        }

        .button-group {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        button {
            padding: 12px 24px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            transition: all 0.3s;
        }

        .btn-primary {
            background: #0ea5e9;
            color: white;
        }

        .btn-primary:hover {
            background: #0284c7;
            transform: translateY(-2px);
        }

        .btn-secondary {
            background: #10b981;
            color: white;
        }

        .btn-secondary:hover {
            background: #059669;
            transform: translateY(-2px);
        }

        .btn-danger {
            background: #ef4444;
            color: white;
        }

        .btn-danger:hover {
            background: #dc2626;
            transform: translateY(-2px);
        }

        .simulation-area {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }

        .algorithm-section {
            background: #334155;
            padding: 20px;
            border-radius: 10px;
            border: 1px solid #475569;
        }

        .algorithm-section h2 {
            color: #38bdf8;
            margin-bottom: 15px;
            text-align: center;
        }

        .memory-container {
            min-height: 400px;
            border: 3px solid #0ea5e9;
            border-radius: 10px;
            padding: 15px;
            background: #1e293b;
        }

        .memory-block {
            margin-bottom: 10px;
            border-radius: 5px;
            padding: 15px;
            position: relative;
            transition: all 0.5s ease;
            border: 2px solid #475569;
        }

        .memory-block.free {
            background: linear-gradient(135deg, #1e3a8a 0%, #1e40af 100%);
            border-color: #3b82f6;
        }

        .memory-block.occupied {
            background: linear-gradient(135deg, #7c2d12 0%, #991b1b 100%);
            border-color: #dc2626;
            animation: slideIn 0.5s ease;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateX(-20px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        .memory-block-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
        }

        .memory-block-info {
            font-size: 14px;
            color: #cbd5e1;
        }

        .process-list {
            background: #334155;
            padding: 15px;
            border-radius: 10px;
            border: 2px solid #475569;
            margin-bottom: 20px;
        }

        .process-list h3 {
            color: #38bdf8;
            margin-bottom: 10px;
        }

        .process-item {
            display: flex;
            justify-content: space-between;
            padding: 8px;
            margin-bottom: 5px;
            background: #1e293b;
            border-radius: 5px;
            color: #e2e8f0;
        }

        .process-item.allocated {
            background: #065f46;
            border-left: 4px solid #10b981;
        }

        .process-item.waiting {
            background: #7f1d1d;
            border-left: 4px solid #ef4444;
        }

        .stats {
            background: #334155;
            padding: 20px;
            border-radius: 10px;
            margin-top: 30px;
            border: 1px solid #475569;
        }

        .stats h2 {
            color: #38bdf8;
            margin-bottom: 20px;
            text-align: center;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
        }

        .stat-card {
            background: linear-gradient(135deg, #0ea5e9 0%, #0284c7 100%);
            color: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
        }

        .stat-value {
            font-size: 2em;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 0.9em;
            opacity: 0.9;
        }

        .comparison {
            background: #422006;
            border: 2px solid #d97706;
            padding: 20px;
            border-radius: 10px;
            margin-top: 20px;
        }

        .comparison h3 {
            color: #fbbf24;
            margin-bottom: 15px;
        }

        .comparison-item {
            display: flex;
            justify-content: space-between;
            padding: 10px;
            margin-bottom: 8px;
            background: #1e293b;
            border-radius: 5px;
            color: #e2e8f0;
        }

        .winner {
            background: #065f46 !important;
            font-weight: bold;
        }

        @media (max-width: 768px) {
            .simulation-area {
                grid-template-columns: 1fr;
            }
        }

        .tooltip {
            position: relative;
            display: inline-block;
            cursor: help;
        }

        .tooltip:hover::after {
            content: attr(data-tooltip);
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            background: #333;
            color: white;
            padding: 5px 10px;
            border-radius: 5px;
            white-space: nowrap;
            font-size: 12px;
            z-index: 1000;
        }

        .footer {
            background: linear-gradient(135deg, #0c4a6e 0%, #075985 100%);
            color: white;
            padding: 30px;
            border-radius: 10px;
            margin-top: 30px;
            text-align: center;
            border: 1px solid #0284c7;
        }

        .footer h3 {
            margin-bottom: 15px;
            font-size: 1.5em;
        }

        .footer-content {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .footer-item {
            background: rgba(255, 255, 255, 0.1);
            padding: 15px;
            border-radius: 8px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .footer-item strong {
            display: block;
            margin-bottom: 5px;
            font-size: 0.9em;
            opacity: 0.8;
        }

        .footer-item span {
            font-size: 1.1em;
        }

        .footer-divider {
            height: 2px;
            background: rgba(255, 255, 255, 0.3);
            margin: 20px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Simulador de Asignación de Memoria</h1>
        <p class="subtitle">Best Fit vs Worst Fit</p>

        <div class="controls">
            <h2 style="margin-bottom: 20px; color: #38bdf8;">Configuración</h2>
            
            <div class="control-group">
                <label>Bloques de Memoria (tamaños separados por comas):</label>
                <input type="text" id="memoryBlocks" value="100, 500, 200, 300, 600" placeholder="Ej: 100, 500, 200">
            </div>

            <div class="control-group">
                <label>Procesos a Asignar (tamaños separados por comas):</label>
                <input type="text" id="processes" value="212, 417, 112, 426" placeholder="Ej: 212, 417, 112">
            </div>

            <div class="button-group">
                <button class="btn-primary" onclick="initializeMemory()">Inicializar Memoria</button>
                <button class="btn-secondary" onclick="runSimulation()">Ejecutar Simulación</button>
                <button class="btn-primary" onclick="stepByStep()">Paso a Paso</button>
                <button class="btn-danger" onclick="reset()">Limpiar</button>
            </div>
        </div>

        <div class="process-list" id="processList"></div>

        <div class="simulation-area">
            <div class="algorithm-section">
                <h2>Best Fit</h2>
                <div class="memory-container" id="bestFitMemory"></div>
            </div>

            <div class="algorithm-section">
                <h2>Worst Fit</h2>
                <div class="memory-container" id="worstFitMemory"></div>
            </div>
        </div>

        <div class="stats">
            <h2>Estadísticas y Comparación</h2>
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-value" id="bestFitAllocated">0</div>
                    <div class="stat-label">Best Fit - Asignados</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="bestFitFragmentation">0</div>
                    <div class="stat-label">Best Fit - Fragmentación</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="worstFitAllocated">0</div>
                    <div class="stat-label">Worst Fit - Asignados</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="worstFitFragmentation">0</div>
                    <div class="stat-label">Worst Fit - Fragmentación</div>
                </div>
            </div>

            <div class="comparison" id="comparisonSection"></div>
        </div>

        <!-- Sección de Información Personal -->
        <div class="footer">
            <h3>Información del Estudiante</h3>
            <div class="footer-divider"></div>
            <div class="footer-content">
                <div class="footer-item">
                    <strong>Nombre Completo:</strong>
                    <span>Uriona Joaquin</span>
                </div>
                <div class="footer-item">
                    <strong>Matrícula:</strong>
                    <span>SW2509057</span>
                </div>
                <div class="footer-item">
                    <strong>Materia:</strong>
                    <span>Sistemas Operativos</span>
                </div>
                <div class="footer-item">
                    <strong>Profesor:</strong>
                    <span>Jorge Javier Pedroza Romero</span>
                </div>
                <div class="footer-item">
                    <strong>Institución:</strong>
                    <span>Tecnologico de Software</span>
                </div>
                <div class="footer-item">
                    <strong>Fecha de Entrega:</strong>
                    <span>06/02/2026</span>
                </div>
            </div>
        </div>
    </div>

    <script>
        let memoryBlocksData = [];
        let processesData = [];
        let currentStep = 0;
        let bestFitBlocks = [];
        let worstFitBlocks = [];

        function initializeMemory() {
            const memoryInput = document.getElementById('memoryBlocks').value;
            const processInput = document.getElementById('processes').value;

            memoryBlocksData = memoryInput.split(',').map(s => parseInt(s.trim())).filter(n => !isNaN(n));
            processesData = processInput.split(',').map(s => parseInt(s.trim())).filter(n => !isNaN(n));

            bestFitBlocks = memoryBlocksData.map((size, index) => ({
                id: index,
                size: size,
                free: size,
                processes: []
            }));

            worstFitBlocks = JSON.parse(JSON.stringify(bestFitBlocks));

            currentStep = 0;
            renderMemory();
            renderProcessList();
            updateStats();
        }

        function renderMemory() {
            renderAlgorithmMemory('bestFitMemory', bestFitBlocks);
            renderAlgorithmMemory('worstFitMemory', worstFitBlocks);
        }

        function renderAlgorithmMemory(containerId, blocks) {
            const container = document.getElementById(containerId);
            container.innerHTML = '';

            blocks.forEach((block, index) => {
                const blockDiv = document.createElement('div');
                blockDiv.className = 'memory-block';
                
                const totalUsed = block.size - block.free;
                const usedPercentage = (totalUsed / block.size) * 100;

                if (block.processes.length > 0) {
                    blockDiv.classList.add('occupied');
                } else {
                    blockDiv.classList.add('free');
                }

                const processesHTML = block.processes.map(p => 
                    `<span style="background: #1e293b; padding: 2px 6px; border-radius: 3px; margin-right: 5px; border: 1px solid #475569;">P${p.id} (${p.size} KB)</span>`
                ).join('');

                blockDiv.innerHTML = `
                    <div class="memory-block-header">
                        <strong>Bloque ${index + 1}</strong>
                        <span>${block.free} KB libres</span>
                    </div>
                    <div class="memory-block-info">
                        Tamaño total: ${block.size} KB | Usado: ${totalUsed} KB (${usedPercentage.toFixed(1)}%)
                    </div>
                    ${block.processes.length > 0 ? `<div style="margin-top: 8px;">Procesos: ${processesHTML}</div>` : ''}
                    <div style="margin-top: 8px; background: #475569; border-radius: 5px; overflow: hidden;">
                        <div style="width: ${usedPercentage}%; height: 8px; background: linear-gradient(90deg, #0ea5e9, #06b6d4); transition: width 0.5s;"></div>
                    </div>
                `;

                container.appendChild(blockDiv);
            });
        }

        function renderProcessList() {
            const container = document.getElementById('processList');
            container.innerHTML = '<h3>Procesos</h3>';

            processesData.forEach((size, index) => {
                const processDiv = document.createElement('div');
                processDiv.className = 'process-item';
                
                if (index < currentStep) {
                    processDiv.classList.add('allocated');
                } else {
                    processDiv.classList.add('waiting');
                }

                processDiv.innerHTML = `
                    <span><strong>Proceso ${index + 1}</strong> - ${size} KB</span>
                    <span>${index < currentStep ? 'Asignado' : 'En espera'}</span>
                `;

                container.appendChild(processDiv);
            });
        }

        function bestFit(blocks, processSize, processId) {
            let bestIndex = -1;
            let minDifference = Infinity;

            blocks.forEach((block, index) => {
                if (block.free >= processSize) {
                    const difference = block.free - processSize;
                    if (difference < minDifference) {
                        minDifference = difference;
                        bestIndex = index;
                    }
                }
            });

            if (bestIndex !== -1) {
                blocks[bestIndex].processes.push({ id: processId, size: processSize });
                blocks[bestIndex].free -= processSize;
                return true;
            }
            return false;
        }

        function worstFit(blocks, processSize, processId) {
            let worstIndex = -1;
            let maxDifference = -1;

            blocks.forEach((block, index) => {
                if (block.free >= processSize) {
                    const difference = block.free - processSize;
                    if (difference > maxDifference) {
                        maxDifference = difference;
                        worstIndex = index;
                    }
                }
            });

            if (worstIndex !== -1) {
                blocks[worstIndex].processes.push({ id: processId, size: processSize });
                blocks[worstIndex].free -= processSize;
                return true;
            }
            return false;
        }

        function calculateFragmentation(blocks) {
            return blocks.reduce((sum, block) => sum + block.free, 0);
        }

        function updateStats() {
            const bestFitAllocated = processesData.slice(0, currentStep).length;
            const worstFitAllocated = processesData.slice(0, currentStep).length;
            const bestFitFrag = calculateFragmentation(bestFitBlocks);
            const worstFitFrag = calculateFragmentation(worstFitBlocks);

            document.getElementById('bestFitAllocated').textContent = bestFitAllocated;
            document.getElementById('bestFitFragmentation').textContent = bestFitFrag + ' KB';
            document.getElementById('worstFitAllocated').textContent = worstFitAllocated;
            document.getElementById('worstFitFragmentation').textContent = worstFitFrag + ' KB';

            updateComparison(bestFitFrag, worstFitFrag);
        }

        function updateComparison(bestFitFrag, worstFitFrag) {
            const comparisonSection = document.getElementById('comparisonSection');
            
            let winner = '';
            if (bestFitFrag < worstFitFrag) {
                winner = 'Best Fit tiene menor fragmentación';
            } else if (worstFitFrag < bestFitFrag) {
                winner = 'Worst Fit tiene menor fragmentación';
            } else {
                winner = 'Ambos algoritmos tienen la misma fragmentación';
            }

            comparisonSection.innerHTML = `
                <h3>Análisis Comparativo</h3>
                <div class="comparison-item ${bestFitFrag <= worstFitFrag ? 'winner' : ''}">
                    <span>Best Fit - Fragmentación:</span>
                    <span>${bestFitFrag} KB</span>
                </div>
                <div class="comparison-item ${worstFitFrag <= bestFitFrag ? 'winner' : ''}">
                    <span>Worst Fit - Fragmentación:</span>
                    <span>${worstFitFrag} KB</span>
                </div>
                <div style="margin-top: 15px; padding: 15px; background: #1e293b; border-radius: 5px; text-align: center; font-weight: bold; color: #38bdf8;">
                    ${winner}
                </div>
                <div style="margin-top: 15px; padding: 15px; background: #1e293b; border-radius: 5px; font-size: 0.9em; color: #cbd5e1;">
                    <strong>Nota:</strong> Best Fit busca el bloque más pequeño que quepa el proceso, minimizando el espacio desperdiciado. 
                    Worst Fit busca el bloque más grande disponible, dejando fragmentos más grandes que pueden ser útiles para procesos futuros.
                </div>
            `;
        }

        async function runSimulation() {
            if (processesData.length === 0) {
                alert('Por favor, inicializa la memoria primero');
                return;
            }

            currentStep = 0;
            initializeMemory();

            for (let i = 0; i < processesData.length; i++) {
                await new Promise(resolve => setTimeout(resolve, 800));
                currentStep = i + 1;
                
                bestFit(bestFitBlocks, processesData[i], i + 1);
                worstFit(worstFitBlocks, processesData[i], i + 1);
                
                renderMemory();
                renderProcessList();
                updateStats();
            }
        }

        function stepByStep() {
            if (processesData.length === 0) {
                alert('Por favor, inicializa la memoria primero');
                return;
            }

            if (currentStep >= processesData.length) {
                alert('Simulación completada. Presiona "Limpiar" para reiniciar.');
                return;
            }

            bestFit(bestFitBlocks, processesData[currentStep], currentStep + 1);
            worstFit(worstFitBlocks, processesData[currentStep], currentStep + 1);
            
            currentStep++;
            renderMemory();
            renderProcessList();
            updateStats();
        }

        function reset() {
            currentStep = 0;
            bestFitBlocks = [];
            worstFitBlocks = [];
            document.getElementById('bestFitMemory').innerHTML = '';
            document.getElementById('worstFitMemory').innerHTML = '';
            document.getElementById('processList').innerHTML = '';
            document.getElementById('comparisonSection').innerHTML = '';
            
            document.getElementById('bestFitAllocated').textContent = '0';
            document.getElementById('bestFitFragmentation').textContent = '0';
            document.getElementById('worstFitAllocated').textContent = '0';
            document.getElementById('worstFitFragmentation').textContent = '0';
        }

        // Inicializar al cargar la página
        window.onload = function() {
            initializeMemory();
        };
    </script>
</body>
</html>
